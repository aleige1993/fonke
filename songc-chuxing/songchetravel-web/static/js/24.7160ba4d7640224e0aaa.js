webpackJsonp([24],{1027:function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t){return(0,p.default)({url:d.default+"/sys/terminal/listWiredevice",method:"POST",params:t})}function o(t){return(0,p.default)({url:d.default+"/sys/terminal/addWirelessDevice",method:"POST",params:t})}function r(t){return(0,p.default)({url:d.default+"/sys/terminal/editWireDevice",method:"POST",params:t})}function s(t){return(0,p.default)({url:d.default+"/sys/terminal/addWirelessFollowCfg",method:"POST",params:t})}function c(t){return(0,p.default)({url:d.default+"/car/monitor/deviceGPSInfo",method:"POST",params:t})}Object.defineProperty(e,"__esModule",{value:!0}),e.listWiredevice=i,e.addWirelessDevice=o,e.editWireDevice=r,e.addWirelessFollowCfg=s,e.deviceGPSInfo=c;var l=a(296),p=n(l),u=a(295),d=n(u)},1079:function(t,e,a){function n(){}function i(t,e,a){function i(){c.parentNode&&c.parentNode.removeChild(c),window[u]=n,l&&clearTimeout(l)}function s(){window[u]&&i()}"function"==typeof e&&(a=e,e={}),e||(e={});var c,l,p=e.prefix||"__jp",u=e.name||p+r++,d=e.param||"callback",f=null!=e.timeout?e.timeout:6e4,h=encodeURIComponent,g=document.getElementsByTagName("script")[0]||document.head;return f&&(l=setTimeout(function(){i(),a&&a(new Error("Timeout"))},f)),window[u]=function(t){o("jsonp got",t),i(),a&&a(null,t)},t+=(~t.indexOf("?")?"&":"?")+d+"="+h(u),t=t.replace("?&","?"),o('jsonp req "%s"',t),c=document.createElement("script"),c.src=t,g.parentNode.insertBefore(c,g),s}var o=a(1080)("jsonp");t.exports=i;var r=0},1080:function(t,e,a){(function(n){function i(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))}function o(t){var a=this.useColors;if(t[0]=(a?"%c":"")+this.namespace+(a?" %c":" ")+t[0]+(a?"%c ":" ")+"+"+e.humanize(this.diff),a){var n="color: "+this.color;t.splice(1,0,n,"color: inherit");var i=0,o=0;t[0].replace(/%[a-zA-Z%]/g,function(t){"%%"!==t&&(i++,"%c"===t&&(o=i))}),t.splice(o,0,n)}}function r(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function s(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(t){}}function c(){var t;try{t=e.storage.debug}catch(t){}return!t&&void 0!==n&&"env"in n&&(t=a.i({NODE_ENV:"production"}).DEBUG),t}e=t.exports=a(1081),e.log=r,e.formatArgs=o,e.save=s,e.load=c,e.useColors=i,e.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),e.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],e.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},e.enable(c())}).call(e,a(113))},1081:function(t,e,a){function n(t){var a,n=0;for(a in t)n=(n<<5)-n+t.charCodeAt(a),n|=0;return e.colors[Math.abs(n)%e.colors.length]}function i(t){function a(){if(a.enabled){var t=a,n=+new Date,i=n-(l||n);t.diff=i,t.prev=l,t.curr=n,l=n;for(var o=new Array(arguments.length),r=0;r<o.length;r++)o[r]=arguments[r];o[0]=e.coerce(o[0]),"string"!=typeof o[0]&&o.unshift("%O");var s=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,function(a,n){if("%%"===a)return a;s++;var i=e.formatters[n];if("function"==typeof i){var r=o[s];a=i.call(t,r),o.splice(s,1),s--}return a}),e.formatArgs.call(t,o);(a.log||e.log||console.log.bind(console)).apply(t,o)}}return a.namespace=t,a.enabled=e.enabled(t),a.useColors=e.useColors(),a.color=n(t),"function"==typeof e.init&&e.init(a),a}function o(t){e.save(t),e.names=[],e.skips=[];for(var a=("string"==typeof t?t:"").split(/[\s,]+/),n=a.length,i=0;i<n;i++)a[i]&&(t=a[i].replace(/\*/g,".*?"),"-"===t[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")))}function r(){e.enable("")}function s(t){var a,n;for(a=0,n=e.skips.length;a<n;a++)if(e.skips[a].test(t))return!1;for(a=0,n=e.names.length;a<n;a++)if(e.names[a].test(t))return!0;return!1}function c(t){return t instanceof Error?t.stack||t.message:t}e=t.exports=i.debug=i.default=i,e.coerce=c,e.disable=r,e.enable=o,e.enabled=s,e.humanize=a(1084),e.names=[],e.skips=[],e.formatters={};var l},1084:function(t,e){function a(t){if(t=String(t),!(t.length>100)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(e){var a=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return a*p;case"days":case"day":case"d":return a*l;case"hours":case"hour":case"hrs":case"hr":case"h":return a*c;case"minutes":case"minute":case"mins":case"min":case"m":return a*s;case"seconds":case"second":case"secs":case"sec":case"s":return a*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}}}function n(t){return t>=l?Math.round(t/l)+"d":t>=c?Math.round(t/c)+"h":t>=s?Math.round(t/s)+"m":t>=r?Math.round(t/r)+"s":t+"ms"}function i(t){return o(t,l,"day")||o(t,c,"hour")||o(t,s,"minute")||o(t,r,"second")||t+" ms"}function o(t,e,a){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+a:Math.ceil(t/e)+" "+a+"s"}var r=1e3,s=60*r,c=60*s,l=24*c,p=365.25*l;t.exports=function(t,e){e=e||{};var o=typeof t;if("string"===o&&t.length>0)return a(t);if("number"===o&&!1===isNaN(t))return e.long?i(t):n(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},1085:function(t,e,a){t.exports=a.p+"static/img/no-data.899d569.svg"},1140:function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=a(109),o=n(i),r=a(1027),s=a(1079),c=n(s),l=function(){return new o.default(function(t,e){var a=document.createElement("script");a.type="text/javascript",a.src="http://api.map.baidu.com/api?v=2.0&ak=K52pNzWT61z1EHvdZptaSmlPRc7mKbjC&callback=init",a.onerror=e,document.head.appendChild(a),window.init=function(){t(BMap)}})};e.default={data:function(){return{map:null,noData:a(1085),time:new Date,pickerOptions:{},tripLoading:!0,tripList:[],params:{deviceId:null,date:""},page:{rows:10,page:1},tripTotal:0,BMap:null,totalData:[],plateNumber:"",imei:""}},mounted:function(){this.params.deviceId=this.$route.query.id,this.plateNumber=this.$route.query.plateNum,this.imei=this.$route.query.imei,this.$nextTick(function(){var t=this;l().then(function(e){t.BMap=e,t.map=new e.Map("mapimpl",{enableMapClick:!1}),t.getData(),t.map.enableScrollWheelZoom(),t.map.enableContinuousZoom(),t.map.centerAndZoom(new e.Point(116.404,39.915),11),t.addControl()}).catch(function(t){console.log("map impl error")})})},methods:{refresh:function(){this.getData()},back:function(){this.$router.back()},addControl:function(){var t=this,e=new BMap.ScaleControl({anchor:BMAP_ANCHOR_BOTTOM_LEFT}),a=new BMap.NavigationControl({anchor:BMAP_ANCHOR_BOTTOM_LEFT,type:BMAP_NAVIGATION_CONTROL_SMALL});t.map.addControl(a),setTimeout(function(){t.map.addControl(e)},1e3)},getData:function(){var t=this;this.tripLoading=!0,this.totalData=[],this.tripTotal=0,this.tripList=[],this.map.clearOverlays(),(0,r.deviceGPSInfo)(this.params).then(function(e){var a=e.data,n=a.result,i=a.entity;n.resultCode||(t.tripLoading=!1),i&&i.length?(t.totalData=i,t.tripTotal=i.length,t.page={rows:10,page:1},t.addMapLine(),t.paging()):t.tripLoading=!1})},pageChange:function(t){this.page.page=t,this.tripLoading=!0,this.paging()},paging:function(){var t=this.page.rows*(this.page.page-1)==0?0:this.page.rows*(this.page.page-1),e=this.page.rows*this.page.page>this.totalData.length?this.totalData.length:this.page.rows*this.page.page;if(this.totalData.length<=this.page.rows)return this.getLocation(this.totalData),!1;var a=this.totalData.slice(t||0,e);this.getLocation(a)},timestampToTime:function(t){var e=new Date(t+288e5);return e.getFullYear()+"-"+(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-"+(e.getDate()<10?"0"+e.getDate()+" ":e.getDate()+" ")+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()},translateCallback:function(t){t.reverse(),this.map.centerAndZoom(t[0],12);var e=new this.BMap.Symbol(BMap_Symbol_SHAPE_FORWARD_OPEN_ARROW,{scale:.4,rotation:45,strokeColor:"#fff",strokeWeight:"2"}),a=new BMap.Icon("http://sirui-img.oss-cn-hangzhou.aliyuncs.com/blackTea-potal/201806/69c439db-6b51-4235-945e-074047685093.png",new BMap.Size(32,32)),n=new BMap.Marker(t[0],{icon:a,offset:{width:0,height:-10}});this.map.addOverlay(n);var i=new BMap.Icon("http://sirui-img.oss-cn-hangzhou.aliyuncs.com/blackTea-potal/201806/169d5acb-abb0-474d-a372-b5252ee3bf03.png",new BMap.Size(32,32)),o=new BMap.Marker(t[t.length-1],{icon:i,offset:{width:0,height:-10}});this.map.addOverlay(o);var r=new this.BMap.IconSequence(e,"10","30"),s=new this.BMap.Polyline(t,{enableEditing:!1,enableClicking:!0,icons:[r],strokeWeight:"8",strokeOpacity:.8,strokeColor:"#18a45b"});try{this.map.addOverlay(s)}catch(t){console.log(t)}},gcj02tobd09:function(t,e){var a=52.35987755982988,n=Math.sqrt(t*t+e*e)+2e-5*Math.sin(e*a),i=Math.atan2(e,t)+3e-6*Math.cos(t*a);return[n*Math.cos(i)+.0065,n*Math.sin(i)+.006]},addMapLine:function(){var t=this,e=[];this.totalData.map(function(a,n){var i=t.gcj02tobd09(a[3],a[2]);e.push(new t.BMap.Point(i[0],i[1]))}),this.translateCallback(e)},getLocation:function(t,e){var a=this,n=this,i=0,o=[];t.map(function(e,r){var s=n.gcj02tobd09(e[3],e[2]);(0,c.default)("http://api.map.baidu.com/geocoder/v2/?callback=renderReverse&location="+s[1]+","+s[0]+"&output=json&pois=1&ak=K52pNzWT61z1EHvdZptaSmlPRc7mKbjC",null,function(n,s){i+=1,s.status||(o[r]={address:s.result.formatted_address+s.result.sematic_description,lat:e[2],lng:e[3],time:new Date(e[1]+288e5).format("yyyy-MM-dd hh:mm:ss")}),i===t.length&&(a.tripList=o,a.tripLoading=!1)})})},timeChange:function(t){this.params.date=t}}}},1178:function(t,e,a){e=t.exports=a(845)(!1),e.push([t.i,"#mapimpl{height:calc(100vh - 120px);background-color:#fff}.trackview-wrap{padding:0!important;position:relative}.trackview-wrap .fixed-btn{position:absolute;right:470px;top:20px}.trackview-wrap .fixed-btn button{background-color:#2f80e9}.trackview-wrap .no-data{display:block;margin:20px auto;width:140px}.trackview-wrap .right-box{position:absolute;right:0;top:0;z-index:999;background-color:#fff;min-width:400px;max-width:450px}.trackview-wrap .right-box .tit{background-color:#2f80e9;color:#fff;padding:8px 0;text-align:center;font-size:16px}.trackview-wrap .right-box .select-date{padding:8px 10px}.trackview-wrap .right-box .trip-list{height:calc(100vh - 290px);overflow:auto}.trackview-wrap .right-box .trip-list li{border-bottom:1px dashed #eceeec}.trackview-wrap .right-box .trip-list li .iconfont{position:absolute;left:10px}.trackview-wrap .right-box .trip-list li .iconfont.time{color:#2fcc64}.trackview-wrap .right-box .trip-list li .iconfont.address{color:#3876e9}.trackview-wrap .right-box .trip-list li .item{padding-left:35px;position:relative;min-height:30px;line-height:30px}.trackview-wrap .right-box .trip-list li .item .txt{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.trackview-wrap .right-box .total-line{text-align:center;padding:8px 0;background-color:#f2f3f2}.trackview-wrap .right-box .pagination-wrap{padding:10px 0;text-align:center}",""])},1216:function(t,e,a){var n=a(1178);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a(846)("74b634a6",n,!0,{})},1263:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"trackview-wrap"},[a("div",{attrs:{id:"mapimpl"}}),t._v(" "),a("div",{staticClass:"fixed-btn"},[a("el-button",{attrs:{type:"primary"},on:{click:t.refresh}},[t._v("刷新")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.back}},[t._v("返回")])],1),t._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.tripLoading,expression:"tripLoading"}],staticClass:"right-box"},[a("h2",{staticClass:"tit"},[t._v("\n      "+t._s(t.plateNumber?"车牌号:"+t.plateNumber:"IMEI:"+t.imei)+"\n    ")]),t._v(" "),a("div",{staticClass:"select-date"},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","picker-options":t.pickerOptions},on:{change:t.timeChange},model:{value:t.time,callback:function(e){t.time=e},expression:"time"}}),t._v(" "),a("el-button",{on:{click:t.getData}},[t._v("查询")])],1),t._v(" "),a("p",{staticClass:"total-line"},[t._v("共"+t._s(t.tripTotal)+"条上报记录")]),t._v(" "),t.tripList.length?a("ul",{staticClass:"trip-list"},t._l(t.tripList,function(e,n){return a("li",{key:n},[a("div",{staticClass:"item"},[a("i",{staticClass:"iconfont address"},[t._v("")]),t._v(" "),a("p",{staticClass:"txt"},[t._v(t._s(e.address))])]),t._v(" "),a("div",{staticClass:"item"},[a("i",{staticClass:"iconfont time"},[t._v("")]),t._v(" "),a("p",{staticClass:"txt"},[t._v(t._s(e.time))])])])})):a("img",{staticClass:"no-data",attrs:{src:t.noData,alt:""}}),t._v(" "),a("div",{staticClass:"pagination-wrap"},[a("el-pagination",{attrs:{layout:"prev, pager, next",total:t.tripTotal},on:{"current-change":t.pageChange}})],1)])])},staticRenderFns:[]}},347:function(t,e,a){function n(t){a(1216)}var i=a(17)(a(1140),a(1263),n,null,null);t.exports=i.exports}});